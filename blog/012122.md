---
title: Day 40 - Fixing the CSS, with a slight detour ðŸ›£
date: 2022-01-21
description: Sometimes you got to ensure it just works!
tags: Django, nginx
---

# {{ $page.title }}

I've been trying many solutions to this recent problem of sharing data across containers, but with no luck so far. This, then, led me to being a little more pragmatic: having copied the static content from the back-end, I'll just serve it right away with nginx - that particular data sharing issue can be solved some other time. Thank you, future Alexandre! ðŸ˜˜

## Serving static content with nginx ðŸŽ¨

I am definitely not an authority on nginx, but here's some of my findings. After having placed the static content on the root of the project directory, it was fairly straightforward to have it passed to the Docker container. From then on, one just needs ensuring proper routing to the content.

Using the `alias` directive, every request for `/static/admin/` is being redirected to a path local to nginx, and content is now being properly served. I had one issue, however: the files were being found and served, but the CSS wasn't applied. turns out I had to set the MIME types for the content. All is working now!

## And just as it was fixed...

...another friend of mine came up with a solution for the data sharing issue (thank you very much, drop!)! ðŸ™ƒ

Now, don't get me wrong: I love my friends, and I love programming too. But it really is frustrating to rely so much on their experience rather than the usefulness of the documentation. Maybe the problem all along was that I never look *into the right parts* of the documentation. 

This solves the issue:

``` nginx
version: "3.9"

services:
  bzzz:
    build: bzzz_internet
    expose:
      - 5000
    volumes:
      - ./bzzz_internet:/app
  back-end:
    build: back-end
    environment:
      - EMAIL_HOST_PASSWORD=AESCALAdosdebatespoliticos
    expose:
      - 8000
    volumes:
      - ./back-end:/app
  nginx:
    hostname: nginx
    image: nginx
    ports:
      - 80:80
      - 443:443
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - /etc/letsencrypt:/etc/letsencrypt
      - ./back-end/static:/static
```

Notice how the service `nginx` can reference the service `back-end`!

<FetchComments :title=$frontmatter.title />
<PostComments :title=$frontmatter.title />
